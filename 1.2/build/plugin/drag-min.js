/*! autoResponsive - v1.2 - 2013-07-22 1:53:09 PM
* Copyright (c) 2013 xudafeng; Licensed  */
KISSY.add("gallery/autoResponsive/1.2/plugin/drag",function(e,t,n){"use strict";function i(e){var t=this;t.closeConstrain=e.closeConstrain||!1,t.selector=e.selector,t.handlers=e.handlers||[]}var r=e.DOM,o=e.DD,s=o.DDM,a=o.DraggableDelegate,u=o.DroppableDelegate,l=(11>e.UA.ie,"ks-autoResponsive-dd-"),c=l+"placeHolder",f=l+"dragging",h='<div class="'+c+'"></div>';return i.prototype={init:function(i){var r=this;r.owner=i,r.container=r.owner.userConfig.container,r.dragDelegate=new a({container:r.container,selector:r.selector,move:!0,plugins:[new t({constrain:r.container}),new n({node:r.container})],handlers:r.handlers}),r.dropDelegate=new u({container:r.container,selector:r.selector}),r._bindOperate(),e.log("drag init!")},reset:function(){},stop:function(){},_bindOperate:function(){var e=this;s.on("dragstart",function(t){var n=t.drag,i=n.get("node");e.select=i[0],e.originPosition=e.select.autoResponsiveCoordinate,e._renderPlaceHolder(),r.addClass(e.select,f),e.owner.changeCfg({exclude:f})}).on("dragend",function(){r.css(e.select,{left:r.offset(e.placeHolder).left,top:r.offset(e.placeHolder).top}),r.remove(e.placeHolder),r.removeClass(e.select,f)}).on("dropover",function(t){var n=t.drop,i=n.get("node");r.insertBefore(e.placeHolder,i),e.owner.adjust()})},_renderPlaceHolder:function(){var e=this;e.placeHolder=r.create(h),r.css(e.placeHolder,{left:e.originPosition.x,top:e.originPosition.y,width:r.width(e.select),height:r.height(e.select)}),r.insertBefore(e.placeHolder,e.select)}},i},{requires:["dd/plugin/constrain","dd/plugin/scroll","dd","dom","event"]});